<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <link rel="manifest" href="manifest.json">
    <title>ようこそ、jigインターンへ！</title>
    <style>
      * {
        box-sizing: border-box;
        margin: 0;
      }
      html, body {
        height: 100vh;
        width: 100%;
      }
      body {
        display: grid;
        place-content: center;
      }
    </style>
    <script type="module">
      const message = await fetch("/welcome-message")
      //document.querySelector("body").innerHTML = `<h1>${await message.text()}</h1>`
    </script>
  </head>
  <body>
    <!--- 送信用フォーム --->
    <p></p>
    <input id="userID">　送信先ユーザーID</input>
    <p></p>
    <textarea rows="10" cols="50" name="comment" id="mainTextI">ここに初期テキストを入力できます(オプション)</textarea>
    <p></p>
    <button id="test_button">SP送信</button>
    <button id="sp_delete_button">SP削除</button>
  
    <!--- 受信したときのテキスト --->
    <p id="user">送信先ユーザー名が表示されます。</p>
    <p id="time">送信時間が表示されます。</p>
    <p id="mainText">送信したテキストが表示されます。</p>
  
    <!--- JSスクリプト --->
    <script type="module">
      document.getElementById("test_button").onclick = async () => {
        // inputタグを取得
        const nextWordInput = document.querySelector("#userID");
        // inputの中身を取得
        const sendId = nextWordInput.value;
        // inputタグを取得
        const sendmese = document.querySelector("#mainTextI");
        // inputの中身を取得
        const sendText = sendmese.value;
  
        const response = await fetch("/add_DB_SP",
          {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ sendId,"time" : getCurrentDateTime() , sendText})
  
          });
        
        //何を送信しようとしたかUIでかくにんするコード三つ。
        document.getElementById("user").innerText = sendId;//await response.text();
        document.getElementById("time").innerText = getCurrentDateTime();
        document.getElementById("mainText").innerText = sendText;
      };

      //削除ボタンが押されたら
      document.getElementById("sp_delete_button").onclick = async () => {
        // inputタグを取得、中身を取得
        const deleteId = document.querySelector("#userID").value;
  
        const response = await fetch("/delete_DB_SP",
          {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ deleteId　})
  
          });
        
        //何を送信しようとしたかUIでかくにんするコード三つ。
        document.getElementById("user").innerText = deleteId;//await response.text();
        document.getElementById("time").innerText = getCurrentDateTime();
        document.getElementById("mainText").innerText = "SPの削除を試みました";
      };
  
      function getCurrentDateTime() {
        const now = new Date();
  
        const year = now.getFullYear();
        const month = String(now.getMonth() + 1).padStart(2, '0');
        const day = String(now.getDate()).padStart(2, '0');
        const hours = String(now.getHours()).padStart(2, '0');
        const minutes = String(now.getMinutes()).padStart(2, '0');
        const seconds = String(now.getSeconds()).padStart(2, '0');
  
        return `${year}${month}${day}${hours}${minutes}${seconds}`;
      }

      //const now = new Date(); // 現在の日付と時刻を取得
      //const hours = now.getHours(); // 時間を取得
      //const minutes = now.getMinutes(); // 分を取得
      //const seconds = now.getSeconds(); // 秒を取得
    </script>

    <script src="/permission.js"></script>
  </body>
</html>
